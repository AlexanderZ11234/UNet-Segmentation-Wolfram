(* ::Package:: *)

(* ::Section:: *)
(*Creating  UNet*)


(* ::Input:: *)
(*convolutionModule[kernelsize_,padsize_,stride_]:=NetChain[*)
(*{ConvolutionLayer[1,kernelsize,"Stride"-> stride,"PaddingSize"-> padsize],*)
(*BatchNormalizationLayer[],*)
(*ElementwiseLayer[Ramp]}*)
(*];*)


(* ::Input:: *)
(*decoderModule[kernelsize_,padsize_,stride_]:= NetChain[*)
(*{DeconvolutionLayer[1,{2,2},"PaddingSize"-> 0,"Stride"->{2, 2}],*)
(*BatchNormalizationLayer[],*)
(*ElementwiseLayer[Ramp],*)
(*convolutionModule[kernelsize,padsize,stride]}*)
(*];*)


(* ::Input:: *)
(*encodeModule[kernelsize_,padsize_,stride_]:=NetAppend[*)
(*convolutionModule[kernelsize,padsize,stride],*)
(*PoolingLayer[{2,2},"Function"-> Max,"Stride"-> {2,2}]*)
(*];*)


(* ::Input:: *)
(*cropLayer[{dim1_,dim2_}]:=NetChain[*)
(*{PartLayer[{1,1;;dim1,1;;dim2}],*)
(*ReshapeLayer[{1,dim1,dim2}]}*)
(*];*)


(* ::Input:: *)
(*UNET:=Block[{kernelsize = {3,3},padsize = {1,1},stride={1,1}},*)
(*NetGraph[*)
(*<|"enc_1"->encodeModule[kernelsize,0,stride],*)
(*"enc_2"->encodeModule[kernelsize,padsize,stride],*)
(*"enc_3"->encodeModule[kernelsize,padsize,stride],*)
(*"enc_4"->encodeModule[kernelsize,padsize,stride],*)
(*"dropout_1"->DropoutLayer[],*)
(*"enc_5"-> encodeModule[kernelsize,padsize,stride],*)
(*"dec_1"-> decoderModule[kernelsize,padsize,stride],*)
(*"dec_2"->decoderModule[kernelsize,padsize+1,stride],*)
(*"crop_1" ->cropLayer[{20,20}],*)
(*"concat_1" -> CatenateLayer[],*)
(*"dropout_2" -> DropoutLayer[],*)
(*"conv_1"-> convolutionModule[kernelsize,padsize,stride],*)
(*"dec_3"->decoderModule[kernelsize,padsize,stride],*)
(*"crop_2" ->cropLayer[{40,40}],*)
(*"concat_2" -> CatenateLayer[],*)
(*"dropout_3" -> DropoutLayer[],*)
(*"conv_2"-> convolutionModule[kernelsize,padsize,stride],*)
(*"dec_4"->decoderModule[kernelsize,padsize,stride],*)
(*"crop_3" ->cropLayer[{80,80}],*)
(*"concat_3" -> CatenateLayer[],*)
(*"dropout_4" -> DropoutLayer[],*)
(*"conv_3"-> convolutionModule[kernelsize,padsize,stride],*)
(*"dec_5"->decoderModule[kernelsize,padsize,stride],*)
(*"map" -> {ConvolutionLayer[1,kernelsize,"Stride"-> stride,"PaddingSize"-> padsize],LogisticSigmoid}|>,*)
(*{{NetPort["Input"]->"enc_1"->"enc_2"-> "enc_3"-> "enc_4"->"dropout_1"-> "enc_5"->"dec_1"-> "dec_2"},*)
(*"dec_2"-> "crop_1",*)
(*{"enc_3","crop_1"}-> "concat_1"-> "dropout_2"-> "conv_1"-> "dec_3",*)
(*"enc_2"-> "crop_2",*)
(*{"crop_2","dec_3"}-> "concat_2"-> "dropout_3"-> "conv_2"-> "dec_4",*)
(*"enc_1"-> "crop_3",*)
(*{"crop_3","dec_4"}-> "concat_3"-> "dropout_4"-> "conv_3"-> "dec_5"-> "map"*)
(*},*)
(*"Input"->NetEncoder[{"Image",{168,168},ColorSpace->"Grayscale"}],*)
(*"Output"->NetDecoder[{"Image",Automatic,ColorSpace->"Grayscale"}]*)
(*]*)
(*]//NetInitialize*)


(* ::Input:: *)
(*NetInformation[UNET,"MXNetNodeGraph"]*)


(* ::Input:: *)
(*(* Applied on a single image *)*)


(* ::Input:: *)
(*net=UNET*)


(* ::Input:: *)
(*net[Image[CompressedData["*)
(*1:eJxkvHd3XHlyJaizZ7uKBj6BzERaJLz3JuFdeu+9997Ce4AEAZIAvSer6Mqw*)
(*vO2urm61lUbqkbZnpN09Z0famdWZ/WfPfouN+L0Eq7XzgAQSIJF580bEjRvx*)
(*HiAIZA2R/+mv/uqviufgg8G/Ol8o+NeNVfCFOVOMRzPhkDyzFI6GC8IA/rc3*)
(*pZvZmsgG4fB7XA67zeF0OZ12pzcQjkQiQb/X6bCZjTq1QiYWLy4uzM/OTE9P*)
(*TU6OC0fHRsfwEE5MTEziMTUzMze3IFpcXJyfm52ZmZmeggO+DbeJCeHoyPDw*)
(*EBwD/f39vb293d1dnR3tbe1tba2treTW1o5HR2dXT2/fwMDgyOj49My8WCpX*)
(*agxmiw1gOcyxXCgQCgV8bhfAhMMJWD1en9fn87ocNpNBp1ECTNECPP8sgpwY*)
(*FwrHRoXkGJ+cngZ8c/PzC4sikVgqk8mkUjHcW8RXNT8P/zQzO4ug4cfGx0dH*)
(*CN6B/j7A2tXV2d4OIFta4FaC294BULsB6uDw2MTkzNy8WKbWW2yIJ1SIBEKB*)
(*gBfpxAORulxOB9yx2ywmHZCpkEkWF+bmZqenKZSAUzg+gUxOzcwviiVisUQC*)
(*L12p1ur0Oq1GrVLBK5NJJABYtLgAUZhDiiESgHVsdATIHQRae3oIrYgRoMIb*)
(*Hm0U1J6+/sGhUeHE9JxIrjFY3b5QqBAPhIIBn9ftsNlsCNQGb1az0WgyGo06*)
(*nQZiLhUDTGBlYmIcWRHC2+TU9MzM7PyCWCqVyxVKtUZnMJktVqvVbIIf0moQ*)
(*rEqpVCgVciBYDPkAkDElpiENAOzwYB9w2tsDSIFTArGlqam5uQXZbWtHUvsH*)
(*hscmZxakSq3Z4QmEEqFAMBjwuu02POw2q8ViMRmAF3gyFTwbwBQhmTPTk+OE*)
(*RORxenZ+cQHiLFeo1Fq90WS2WjEUTpfb4/HC4fG63RAS8mBGg16rAYYVCBkx*)
(*QzrMTo6PDg1A/PsQakcbIbW5iRyAtbWtowM4RaBzYrlaD0B94UAg5PdCblqt*)
(*gNNqARoBpBoeVw7ZJkcy5yHiWBXjGOmpqenp2QWRFHJRpdEbjADRBgg9/mA4*)
(*lkjnsrl8LpdJJWOxMKlMu82Mr1qnVqtVkECYvxLMiIXZqfHR4SGsqzNSm5sa*)
(*8RAgVEDa1d0/NDIxsyBRqPVGiz0QCAfgAW0Ep9lowFADiRJ8NFIR81T5TE5M*)
(*TgDGmdk5SEkItUqlNVmsUIlOlzcYTWTzxeWVtfWNjbXV1eViLptKRBGoy+1y*)
(*4GvXY9pC1iKh8LCYCaK5mUnhyNAAUNrb09XV3gp8IkwBAm1qae/o7h0cFk7N*)
(*LUohaBqdPxzASgeY8HgGYFIll0sl4kURViwUMnCJOQUSgzk5u7CIaqHW6YFI*)
(*u9PtC4QT6WxhaXlpqVAAJnPZdCqdSiST8UgENAQ0w+/3+fw+rwcA2y0GLeYR*)
(*IQAfH5CODQ8NkvLv7mxreYu0sam5tb2rp39odBKqAEpVKg36XMgmRByFUqWU*)
(*S4gIUppCiAS9hLpBkPATMqBSazAD9w63P5yAMBeXCvlsKh6LBAN+nz8QDIVR*)
(*e2MR/NoLeep2Ot1ujxv+KRQMBX1uu0mnAqwSIgaAFMM/iOVfCr4AkTY2tbR1*)
(*AqEjQmQIg+hxOUvFo4cXK8d0hKpBQUeUoEJQ4eOoQBhvqRy0x2h1QL34AGSh*)
(*WCzkM4loEOQCKygQisYSyVQ6m8kAs8lkMhYJg5Z4PG5oHy6sMh+8jlDA6zDr*)
(*VTKgFXR2fmYK6h81leRpawsCbUScJEOHR1CqAYDTbgc1MQOZGgVVNLMzUyjM*)
(*KOmglKTnTE7NzoskMqVGZ7bZXR5/KBrPFpaX87lUPOxHjPD8EYCYzgLELIBM*)
(*pTKZdCaTTMSj4SCEHeLudkHgQJydHp8fksFtM8ITYhIszk1PCkeHB0hJAdLm*)
(*xqZGrKW2zq7ePpD8wcHhkbFxSE3Ic1A9NUR8oZSOqOeok9AdR7E1Ts9B7ahA*)
(*cZ0IKZouFFdWlvPJaMjvwW+EkcVUOo0Ys5l0Oo0fMjnAnMJMDUSCPoLTiYcD*)
(*ewjqQ8DjMOtABJRyqQiqf2yENCpAiolKqVNXd08PdNJ+aE9WKygRSJxaBlzO*)
(*YMlMIEaAOAptbmR0DDV9XiRTaAwWpxfVJ7e0trZSTMeCXrcXMGKoqSORTCQS*)
(*8Xg8kYwnEXQmm81iZSUSsSiaBUgxF2J0YnuG3IHW7HFY9Gq1RqOUzM8gqdCo*)
(*oP67OlD6WyH0nZ2AFTR/aAQ6DwgmhABlEjsbhhpAjgxDLwbChVNApkSu0hpt*)
(*Tk8wkswtb64v5xIhLxX+RCqFAJMIBesnjO/RaBTREooBKxCcTmKhIVZkFLAC*)
(*ToTrhI5gh8oAgZWdkYqsgvYjocSdkOY0BFzqNSq5GEoPymZ8bAwAjhJ/Mzw0*)
(*MjI2NjFLfIvOBDBDyezyxtpSBqn0BAkSeE/EYwAsTI4QdYRDgBe+GYsTsJAA*)
(*mXQS/184RDQKoIKqwWFH3fC4wO4YjDqleG5mQojdH6B2k87f3o7RR6CAUqOQ*)
(*LkJjnBwnPALEkRE0YUOYvpOzC1jlepPZ4Yvllje2VtNhL4Q7Gk+lIdRxxIjw*)
(*CMRgIIBNGMokgAIFRwSJRQnAI5VC+QpHACuoFWih00Vpogu+tJpMJoNKPD87*)
(*JRwdGhwaHOhBTtH7tXeCM+mF1gtkYsghJYFE5BHfB4eGRwlMkVSp0ZsszmBm*)
(*aXVzczkRC/hDUNkQSoxlBKhDgEGABlTBG1QMapTHh2IaJFpaSgIorhR5abFI*)
(*CC2FCzMV+hlAtYNsQeOymNSyBSKpoKkD/T1gSdGVdnZ296jkMtQwysuimR3E*)
(*A9kcHhufgvYqU2r1Bpsnll9dW19Kx+BZU4SaBEYRICKB0Hc8JemBWNrRFCJX*)
(*UClQ1sEQ5ECcIhV1IJXEYoMfBmV1I1Ik12Kxuyg7oJHOTQNnY1DCQ71g/DoQ*)
(*Z1ePXIL6hVYLc3IAjv5BcNSAeXR8CoKuUGl1JkcoVYQizyYTqWwmnslB2QCT*)
(*YYLQRxgkltWOHQMam9lsMoPLsyBNbg+mCWCNxmIJJBUlFjMAHwKdGnRUfI3A*)
(*JsQfE8GsFs9BiwF1Fw71Y0PtApxdIkImVA8wSVD2w4ehIRSkKWJWNHqrLwox*)
(*XyskYunCUjEbywGrWDNBvx+fBesWmoWF4IOq1Ou1Wh1YZj24KTSlYKcALLTN*)
(*MCRrnIgAlBbGJHFWWuRwQW1Be/V5nIB0fg6N5Njw4ADpU11d8zMk5BhswNgH*)
(*lrB/ABsA1YNgQDG6gvF0fnkpm0rn88AHJBuUCHLpdVN1gBBB23TEy4M5lsMb*)
(*HmCTwelodWj+QIrcgDUIcotaVsoANC2QsFEIDpadz+Vw+SGZ/G6LRoqDDjCI*)
(*SGFG6ZqZQC4HBwaJbvXBMQCFju1/jpSQxRuKJXPFfDZbXCoW0kgBlDN2QhfS*)
(*aLOAg8dpgwCUEdtGzDtYQjjA6EhlCpVGp8d5DLUdOkUYWywUFmYBdi9UDnhY*)
(*KLcoEbxYPBbyWFTQ/xfniPXD6GNtAcY+4LIPWhRhE1r61PQs2A6lzuoLhpMg*)
(*1dniynIBUisZDyNGYtMQI9AIplpOxjc0gpSFwWET/DRYLJiN5hfBGoAX1EIa*)
(*oBf0oHWCbI3FzwQLwSJuFLqwz+2LpDPJsMsAtko8P0WA9nSDFmG8cVzBVgp9*)
(*HwcorCDwp0YY9SDqqVR2aQXMbzqJptLjoWYKM+SilrhfCSLEqZKaRccoDYam*)
(*O0oGvimcpIhvVWlB4XD49pRKK47NDNMAniNNgCbiITCB0Uw2EbDpwL8tTBOg*)
(*fUMkLaGpwtENc97A0IhwHFsl2H0IlTMAOp3KQ8iRS+zSpJnAvGYg0wm4M2y4*)
(*4FsQ3dDZ0NNL/ENvLz4eFOUYTtDgsUVSOQ5UJovd4fJQ6YqdIJ6Iozcg3Q0t*)
(*lt/l8MTSqajHpFZIxTPYTYew8ZPJrxsbft/g8KhwEsZRhVprhLA6A/CaMwW0*)
(*mZlkLITi7LCdGX8y1s8R/4i2jIyPoCHQktvwAI1G5evuJlMuKU2Y/0RiyFet*)
(*wWS1ERfrD2GLxSYbgUwAH5PC7hFyWq3uSDIesGmhC83hYgOjTc3SYKKghkbG*)
(*wXhIVDo9iqAzGA5FszhRQH+OUTsTiLcBHAG8UBjG0DmODCHEro4ObMY4jJPB*)
(*kVgz9BLQpEt7jsERTPyZuQX0NTADYgZ4UFyxF2C9Q4FFESuEzW01WL2ReNCB*)
(*hhqlk0IIhU/2EJCbkzPzUg2MP0b4j9CwI2mwZmDOE9GQz+MiKHUatIyESeAR*)
(*ooxLmLZmQAYOVyBoEDQ08PkN8Anmh5LnbSmtD4CH0fEJSAExTKuQADBOO3GS*)
(*BuscgCcjQ0sMXaDXZTUY7DBjuowqeK6ZKQhUB+o9xeYovN5FhQ58s97gDAa9*)
(*3nACrTk0yXDA58Zlk16nxhlqAZrb2CjRNrTgTTjUADo+j8fj4o2LH3k8xAsH*)
(*AG4Gg94BMyTZdIzjIkWCQ4wB6gqSFS0Bzns+yr+E8dmsBo3B6Q84jRC6+Zmu*)
(*M6AEJjyASAn6YdAZPeGQ14eynMrAdIExt1nQTyvQUIMCj40MDvTikqClqYkC*)
(*iei4HDyojxw2G+5yETjChZkHFwjgKfqHxiamFxYXCanQBSyIlQIL8ynaLUgF*)
(*n8uqV6nMHq/TgLxgo0ecuH4YHZ+cEasNWMtWfyQAc1k4FEkAmdCGwc6AnyVc*)
(*zkNWQkcD9SVTdyPGmQcoARabzWKxWfARPrPqmfV4l1MCy28QUHNPRzfGXzi7*)
(*KMKGB/WP/RW3HOhePOTApYobvL5SrnN4XUalRIzpT5wo/ujkrERjMpt0emco*)
(*4vfhIAv2KBbGhmal9otSRAl9d3gQuSS7IUAKOIE9AFdfD+/19Uw8ACjr7GDD*)
(*a+Ai1AZBU3Nzew/UwfjoGAznkKhkO2UE40KsgJOMpk5iSexmvVKqtnrdZpUM*)
(*cGIssFsKJ+ekWoCpN3txngHjFYzANBEKeJx2q8mgUYKg4xIDGy3YA5RIaAw4*)
(*IzQDUi6gBHRwY8DBZDABL4uJH/EgWJFYLr+hsWNwYnpcODczhiU1L5ZjYyWe*)
(*xWKlNoZkc2jH5atBLVOYPdDvKSPai91yEgodg24NwowI5ecHFQbz7Xc77RYk*)
(*UyqaQ2+FZh/qB90rwuztJlNXUyOffUYlBRMwMmgM/FYJKoBFqPzG7pFJ6ClD*)
(*8xOjIKo4y6Kk6vRGExV+sjW0YcpCFA0amdzo9lhwUuoiMKcXpCq9yWiwB2Mh*)
(*fwCsZTAWxS0BDDFmgw5kbHGWOEAwgL0dkGR4QGJ3trU2N7e2t7Y0C3gYeAKL*)
(*SWdSCcAiGXDGKoCF+At6RkbaJqf656ZGhzCK02Q3gMWPnOIGCWZ1oBYRYxzl*)
(*ANSNUe+B7gYwJXJITqMjEgeYfnDiYZy7IeTQftRKmZiaXMHn93b0CMFdyFVW*)
(*rz9TiEe9qqkesrdsFnBZVIRJUlLISqFn4jt+YHIaugaH+mbnpxfHB8H3UCol*)
(*QqeLK0qjyYLxt+AN3CCuYrUKucEFUUdFEk4vSmRqk8XkisSgfPxeL4EJKUIW*)
(*OnKwWCBFw4OQmV39IpMze+erX/713/7ND19/8Or9B4e7u1H5IO4xm/ioTESd*)
(*oPhZhECqukhpEbAsXkv3sHB0an5yqAcccC+FFAtKpdYZDAYTOaAdAlYHUAoA*)
(*lEpDG2rvsBC39iqjxQIwYfjye3yhSBjqxwa8azVKqHIYrkdwDuzsmLUlrv3x*)
(*3/71t5/c3bp87fTO02f3Tu49//BpRjLaD6Lfhl1TQIkpu3S85ZbArOcI2nrA*)
(*lg1BjrfidgYUEbvgIi4zME2NxjOoYAQhTSHtNEqECWyCP1CaoPlHw2BiAl4f*)
(*Ci0IGDmNAMI+C91nuL9/aLCtR5u8/tv/7Z+/2o6mgokrN06OLm2vX378+vFH*)
(*L/bj+gkY/nGjCc/fiF0JWSV69TYTmARoQwtaFHhN0Kda2wilUE/zIqJROoMe*)
(*WcWqImLlwLMZGhD4wbGpOZFYbrbbQY8CgXAQYfo8ZF8JrkgC8yjuqft6BwY6*)
(*Bp3rH/7ht88uZY26wO5BIR1y6xUynW/7zqffP7tznJSOjw709XVB0rc1NSCn*)
(*VFtiv1VWUmhMFr8R8rm1kcflCwRQhKDeI8JpPL0BEqWFCQaHK0MJKYTeZtL3*)
(*AJtTIA0Ks8vpjUT8obCfwHRhXmhBMsmgNzYCgtnX29Hr3Pv6j88+eJrXzM9Z*)
(*c/l8wKEVLYqFfeKlS2/++N2jp0XVnFSjVkz3gqlragBCEelZ7M9qCzWABf/C*)
(*hprj8PjQpbBFDY1B4S/iKSOClIyC5GQG6r/V1DconIIOJje5wUWHYcoIeDww*)
(*/rgwKVQQ8gWcmkeHoJX3dLZ1qq98+p9+8/kVw5zcarB73EnD/Hhve0/fuCwc*)
(*3/rsn//+sweHG+sxs9FpEnb3UEAJyhJWNutt9Bl0BrxjlUGbEjS2tHf1QTmR*)
(*vSAolEar0WjUWi1OrZCtUPiWwbHJWXgZRnAAkZAvGAGYeILLCsKulKHDnMLp*)
(*tB+maGhcM1svf/7H397WLMgMRoPb5PTOj460NzSPqJy5pfzBe//3//PrR3tW*)
(*qccsczvHenvamwUNPMqOsDklBQCoVKsCqEQAsE3xGhoxSwdHgLJ5bKR41kGF*)
(*syogNaBRsdrxHM2iRO/xB6NBD7WpBJdp1GkhMdEHjwtHhoFMbK+9A/kfnm6d*)
(*bFnEczK1Jpmxm1TTooXuruE5mWdz99LlWz/+93/71YlOnDry2ZKGgW5cDmOS*)
(*lsjkELhsdj2lT9CtmFR7BU75UE+dPQPDYyClYhj68FQZDtUaLREAGFTGp0Bj*)
(*dW4wHGFfAFdU4N+wScplkgWYmaGXD0L9trc1d4z0GB7+4n7a5ZDML2hCflfe*)
(*viiFfx/CYBkzG7f2T5//8m//7ZdFb2C5kCoWjLMDLbjCJuWEDooKPKl90lTP*)
(*fAAkK5sLlDa19vQPjkzMzIlglMZTOIgUupQOa98CNSTRusOxZMQXBFHye502*)
(*XPRLRLjOwbMRA73ohJu6x3rFV77+46uQ06V1Gi1J+6RCtjDb29bYA9q7INEn*)
(*r65D5E8//CrtiuaKB588y7s0050CPvgOyk0hSAgzaVilwBOcb4EKmtq7+iEN*)
(*yblIGQ7+BKkWfZ/RPLso1bjAZEahnZMzxDajltJ16JJ4ygSmCpgpekZ65zef*)
(*/ubnBavHrffZzS7d4sjA6Fgb1GvrjM7odDgiXnfx6vGVw8PD3ZvHsfd+uLsT*)
(*cakmepu5HF5JoKhyx4Rkn3k/KksZVOwFTZikw+N4Hg3PmUqkcgU5J6kDpAgz*)
(*ms7GAsEoDOdnMMnKDAc0MlY0gRMbkmc2n//x2K5xBLRyi141ANZ6fKKrgSto*)
(*m9DZ3Q6tWuNcu7L/7OG9H5/eeXVcTBRO9wtx0+LMUDMXgYLHRxFl/2QA6klJ*)
(*nYFFpA1NrZ3QHMenZqnzzxKpjJw8xSSV61zxbD7uBXMUCnqhzjUqGXjh8dER*)
(*PKnb3UGKoblXKPeYNv7rL9aDNr9OND09OzXQ2T4t6mnt6OztHhibmlUYZBLD*)
(*+v1rD28fPTy9/fk//OlpPru2vp6wK0RTfdibeFzUo1JGsqhErWcwkFY6nZQT*)
(*qwQUTxoBUnA6ixRSPB2n07li+WLS68PLAjx2M54sEc9PTxDF7O7E6Qfmik6h*)
(*WD6h/O1/O7X7ww5oxMKB/r7+aelIA7d1bKytu6N/an5mXm03xDZXrbHMytru*)
(*1fd/8w93c+lYKunXLEyOtvP5Aj7EmxBXB6BA4jmYq0Tz6XQ6g5IoqPuWjp5+*)
(*3LxOzyKpiyIMvhootUdyxaTHjW3IbTWBGqEbhmY+AHkJZDbhUNE0MKeRST/6*)
(*j/smGFLNAS1unyfGxrt4bA6/ubO5Tzgmls/MiBdnLAEwW9GM22zThp7/+fev*)
(*95ZyubhtcXKkE4w0n8Nltc42s9gMOmJiEZz1pO4BKIPQjEDbu/sHYXjGpcQ8*)
(*cCKWknLyp4opj8OHLchq0mEDQjc8MthLTuORIa2hQyg26I7+y6c+YFXYr5rr*)
(*mpib7O9tZvPByLW2tQ4vjIxNCwfH5qWiGZVT6zGb1eJZXejWV//5n3/1+s7d*)
(*21m1sB9XEI2CZkG3gA05WofC9NagYt0DUjod0pfLa4R2D72JWknML+BlEriZ*)
(*iuaSXqvT4/Y48SypbBHJxO1BFzkxhqNkQ/PggsVZ/PkfLutlU9DlNZqpic6W*)
(*jo4GNq+tvVU40AJzS3d32+CkzKwZH5oak81p9XOzxmBq5ejpj3/6+Y//9PM9*)
(*g2i0D+bvtkYe8Mhg0mvoTDqD8s+kluqp2GNCcEDyASheIgKU4kUnQKlEpkik*)
(*fGYLnn426TUIk5wX7e8lMMFGgpFsaJ2wJtJfff2ioJufGuxYcFtcjjGYiPhN*)
(*7a3tgzPtDWDkW7v7xkViVUQ0NCvVzyrNYuEijA/5QvH6s1/96b/98zXz/Lxo*)
(*oq+ro7WBA5a5YagBCSTuqdRF6aXQA1CeoLmtC3oTnsbA8+g46Etkcb/ZaHOi*)
(*uIPRFJVOifd0treQaZeHw2yXtLh84z+8vBE0jQ3MDkkCgWzWON0h6GgdGmpu*)
(*amtp7ero62prH5At9uis40OTBqdaLJ4bX5TLzQFf9vjuq9/+y5+fZXQKtWSk*)
(*u6uFz+WwOqXtHD6dwSYxJ3MJ8SVE9EnoASiObKNkzTdLCj9o1ZlgXDKA7ZAu*)
(*zk6S/QFZcggaqAUHXzCg21n+9OdX1rNB6dR4+3w6vxI1T7cLenqmZvi8lp6x*)
(*9vbBjsbGDtHCoHB+fmQidSVjnF1UQhHIfT6Ht3Dl+Re//vtvb22EXMrR7rZm*)
(*mEz4jfVcPmnyDNKTSiMqOihkFJ6yuR2GtkFcSMLkjJSK7Fq9FWYgGC5gngQ2*)
(*oU12tLfAQN5ArWG4Dc3Duo39v32USi9fXjH08LrH5A6FdBCkht810AL4+lo6*)
(*BNxmmF2Eg33CaVFwJ75UtOj9dotGYw9ZlaHCwaN7r77+8sv7ccOisBcfm88h*)
(*0gm5Sdwdo1Tw+IlJgPIamvD0O6F0kjrzb9CYYPgkuQlsjgxSuxgBiTmaMR7g*)
(*NGxf/4eTlb18KqMbGhjuG5qdne5vYAmaBO2djYL+rq4ubkf/nHh2tG9wctJQ*)
(*WAnGM0FrNJfxWK2SaYnaltmO77388Pe/u+U0G+f726FzNPKJSa5ncRFmHcHJ*)
(*pMDSUbTgWZtaO7p6egfI1UGgUAsqvQ0sMVS6aG5SCKpJkQlkAZdow3j8pn7d*)
(*0q1/efzyRj7tnOoflQi7Roa7O5sFrYN9nY2tHbNzE4M94/PC0YXF4Ump02sy*)
(*q0Uql88fjdmcWpE5FvQ5El67J/zi9398AOOjeqqnDVIfMx96J/dsK0HiTi+F*)
(*nkUBbe/qhrEZz2lMz85pzDCfa9Vy8dyUcLi/p7NEJrV54yKfLR0y//P/9/mH*)
(*x6mMXtg9vDAh7G5vaezpFQzCKNQnkQnFw32jQmHf+PSMfFbmCJsmRFar3aBN*)
(*BGz+jUwyF3NaCnHXweubT/6v1x6T1qoYagW1w3GUOFEqMxmluFNlD20AjF5L*)
(*eweOeHiWdXrWaLOY9WqFZB5g9vXA+CUgj8Flk1mR5GfbvPkX//r0xvFW3qoY*)
(*GFCohIMdkMP9A+2CltF5r2RAMQWjoGRSODWxMDZozUXEmnjConPaXIrYuj1o*)
(*0Hh1xa3I/Uf74Uf/55dXwt6AeLS3mUdsCbEgdHIQpa+j7jJLrYm6mGUQ2ujE*)
(*lMVqMsKAPj8tHOnv7mhtFvB4nLMhEXdsXOBz2vq//NOD9Sv3diNu8YLGODo4*)
(*MDw8MDTY09TRr9QK+wZGegeUqs6W3rHx+XmjPymdsqyH7D6NTWFx+a0GhSa8*)
(*uV44enZnf/XRn//paT7ocjpmRjsa+GjtgTsGoKurI5E/gwz3iSWlrmbpx4Wn*)
(*FdcNUEPjw/0QziYwtmxivjlsasHGE7R0LcT+6z8fZjau7UccdpPBJZscGJgW*)
(*TYMB6B6YGetpb+8ZnJ0WDne3DgwtiISzSbvK6cscRYMhbyDu0GQ2vYFs/vrx*)
(*xure6vrjF9+/nwgvpXy2yT5opCw2mUOQybpSyTNK5BLFLwFFRi0wV8pFsxOj*)
(*A5h1ZD3IIiaBTWYvLlfQ0i1b/T9+e/Xg2tVNt8bs1hv0i8NjC/MLE7293c0K*)
(*Y1fn0OBw76hUMTk4NLq4OKrbyqQT+YPjoENpLMQNYlc2no7ldi8vuSy2eOLg*)
(*k+9ubGbza+Hpidm5Nr6ggcvj8JiIs66Oyk4CGTIAyx5jT9a6w2O4ZhLPTY4O*)
(*9LSBsPE4JQdbWq0Cn00tverdf/3svetXt5J2udaq0bm00zOLInBeM4N9Nu/c*)
(*5FhPS49EqZMuahN2icx3dXvn8PLGTkq6ILW4jTOzMlNu62jZGw5o5O6Naydf*)
(*/fD6asRols1ODLc2CeAJuGwsHXpdbS29lKCAmap7YvJBoHoHhmEYkixMjw32*)
(*tBNVOxuySyMiB4xb66B57x8evXx8tLWaEhu8wVxcPTG5oBJPz0nFUpNepx3t*)
(*6RoSaX0qhSerlhj88eOrGU9qOWtUG/RKhUw5Kwot377kMNg8nsKj0/0XX/74*)
(*dFmu1aoHGpqamgUCQQOnnsMkhIKQIq215D6d1D00UfAlnb0DBrUUk7Ovo7mR*)
(*xBy9AZWhpOK5/Ob2EePBvzy4/f7t03uPjIZwOmQ2a7UOq1MugrFVJFfrFNMj*)
(*PZNqpVjit0gNFovfZdGo7Vshi0KsdOoWZQsLHv9KVmf2WNw7b+4d3L734xc3*)
(*s6JFlbIH/LsAQ8/hQzHR6uh1jHoKI5UFpNuz4T80tXT0aUCSJkf6u1ob0SFQ*)
(*ayDW2wUG4GxqHdVs/sPp7p07Nx5/6pAG4nZrdjmRsntVEo14dnhK49AsTkxK*)
(*ZCLFnMrlkEv1LpXG5iquZcImc3xrSz6jsHhjBd+iwuz25YtX3uwV7n/+4HFc*)
(*ppL3dbZDdyYNhVWPca+lIcx/BxV7ExnuoRFh1NuaCEwyCUDrxXJnkfMq4Akm*)
(*NSu/f7hz+2Rn6V5Cb9NYHPZQzGPzGLXy+ekp4aTFoZ4Ta4M2r3pBazaqTHpT*)
(*oHh3PxnPb2Qj6ZjBGQ/bYytJucyaP760+/jr9czDb7/79as168xQD9impgYu*)
(*mwlPVU+vpRFsgBch1xLApOxBoFrblZL5ieHejpYGUkLIJU7XZBtInaPgdcwr*)
(*jv/zw+3T+9d3bhSzKdnMgntpL+yOG+TyiVnp5MSCRjQhVnhdllm1X68JOHUG*)
(*vTUWdFn9qzmT1mFxJ7OhwvUli8GTKBzc/PJubO/g6gfPnv+4OTMz1A7SA29M*)
(*JpuDkUd0dIRXSw5glw6mBDsjv0W2OD060NXaxONQ4wrwTBp7aX/FbWjokxhf*)
(*/vnxxsaj+0/2twpLLpEt7/PotB7wMHr53MDw0DjoxbxaKpfKpBrPkklrVqpM*)
(*NqPN5g9LrMW4Nb53euvmsi8ai/uS6YO17G4ukLvy5X95bpLODPBbhP2CBjYD*)
(*CGUCobU0Gq32DCV8VcckYt/I5TSIZ4SDvR3NkMys0qKf+3ZrifopEPQtWp/8*)
(*6dMtX3H38tGGP5rcWtHOLmjMikW53qSY7JkYGRVJJmYkcwuSBeHMolHvtGkt*)
(*BodpflERdDusJnNi69qz68tLm95Q1B8GKxXLra6cPP/1VxmvuLsjeC8+0sZm*)
(*QgBJhtKQxFoaFXb4wOLxBI38trYG/sK0sL+rTcAj7ZYqIeyWpTqCcYXXPaO8*)
(*/Hdfb7q8udVtty+6fzdjldlSaqnBqFIpwBBPqlRysVwm05lV48IFscxgVjm8*)
(*bjXM9Jmo2xpLOMyepWJh/XA36nSHgzFXYGX3ytNnd7/58NjYNXqwrl3o4wBO*)
(*cCUIra7ubX7CjcGBwb++jtXW1DC3MNaDdLLPzvOhSWIxyT6ICTcuu2tcdfU3*)
(*X53Ek0s3dgxLO9mE0e5NRV1Om0Kq0s5NTarNEmj6BrfX6NBLlHMak9HoTrh8*)
(*MpnRm/T60zHLotgW8yaWUvFIKh3OJDN7O8dPbtz+5usvojKlWiSc6SXMsDh1*)
(*TDatDumklUIPOLlgLFkNzYKGmcXBrnaYrYl7qScpyeHQaOQUJZPkac+c+tKX*)
(*v/5oafn6s8fbB+s5syGUSaejYqsVT9Atagwik8ZlVutUartNNStJbTldJnfY*)
(*bXVbFEFfrBA3qxaUiUzQri4u+SAHrsWKqf1ricd/8/m3SZNVODDcj00JOiF0*)
(*TwKujoZZSu4x2FwWr62zHQbK6bHezhZBiU6CE6hk1HPOzkty2O0zyo0v/sM3*)
(*t1988N7dq2vBtNMVD2ZX3JasVz41NT+vWLCkvZCtZotXr7FrFP60LeBSa+Qe*)
(*n2pBr9LaU2serTWxZlBDv7XuHlw/2itEbhzlr79+/ecnDtkotBc2RwCjLZvB*)
(*BzpJ6Gk1BCitFnDwQMFBE7hjw11tEHZqvw+qCjxy8L2evLHZXHbzyEzmF1+/*)
(*/Obr929e3kmGI+5YKuCya1Neq3lhck6rUJn1wKXWaYup5P6oTmbwLK+AnQ+4*)
(*HTKLS6bI7KQ99lBQpZZLJ3X5re3tLx7kt9eOHzx+9vvvl53iVgDIa4ECYdQJ*)
(*+LQa4BBx1tQQUulMcHeojRzWyACO/6ViR2D1ZydRWGTlAxXfPej7+R8//vHJ*)
(*3eO1bKy44l3y26OZYMTmMGqlRpdRKZWoFFa7SW1VK2xenUjmSq6vLqVdOpNS*)
(*DLXvXL21EbCL5uUGw8SsJbl96fmTo63d6w+PP/zul7dj2gF++2h3dwePCSRW*)
(*V1XR6AySoRSloPMsoj31jCGoIgx7iU4OMUv1FEysf1yeD6c//erLrz56uLke*)
(*zl9b9WWTttxmwqnzhg16rVhn1Pl1Kl/ALlfYjBabYl7mTsZy2xmbTCJVeN2u*)
(*ZDJZcJkkiyKNXrToTOQPTzO+2MHu6emHv/rdp7uKsc5xl6anmUOrqigvKyfy*)
(*WQp+LUGKawg0U32d2DKpVTTzLZWs0kwAnQmUQbj06r2vfvzyxcn+wcFyzJcM*)
(*qGIwntkdCmjoSmvQE/J4XA5vyKgNRwoRiTYUNGfWfRG/atETdLtCSlNKJxOp*)
(*NAalWmWJxYrrJrUst3rt7qs//a/fvrAKR0dnJpsFrBp6PXe0hVFdi86JBrTS*)
(*ailaiUDRaL0drXiel0VOQJCwl8754t6H2H9Ow8zexx/+/PuHjx6e3Mq5TW6/*)
(*SRVOhb1+vUIutTm8EXfQ51YpfTGzxFfIRjXg5h1xtzaS8UHQvVqdymTRWzym*)
(*qEPjMppSEX/EZQ09OT24/MkPf//7D/ML06NQzlwGY17bN9tVVU2j11KBh6Oa*)
(*hplaS5Kgux3MKotam9XjCv3tFo3wCW6E3y6/9urek8dHu6url/1aqScWsseT*)
(*odylkFEyJdJYQzGf0++0OSNOndFrdXvD/qMte9BrMbpt5uWCy6DUakOpUGB/*)
(*NRSweZLJUCpqL75/svb8q89++E/fLinnhqGeWfQ64SK/nllTU4eGvra2pnTQ*)
(*SEXBB6giPMFPbcmpoid3z07vsLitXdbH71+78/3toM1dyAdc29txg97my6RT*)
(*Ic2sSKw2xyOhYHI1kVpd9hp0xvjh5tG63urVa+3B4NY6sOe2OlPZWNJrNepT*)
(*IXdodSlePNzc+vjbb57/8LfXzMqxhlZ2HZ3Gnu3itdNrcOlQV1tTDW/kqK6m*)
(*ir+jpZHHZZFJv3T+qbQyZzCptVRzd2/8xf37r764FPFGNnKrN18dF4xakyds*)
(*sgR9GumcXO2KBfKZXC4dDPk1Op1z99H1uFpucdksXn8y6/NqNXKN0hlJGLVm*)
(*ecI57yquHqysrOy8//TOwaf//aOAda6plQsent3F4bYxa2DwBD5p1dUEIMCs*)
(*qiI42xrB0bHISRLq9BOTWkidrc94zf2i/J0nL1/fPl4P5VKm4u/ebIZs4WAg*)
(*4LRa7TqtWieT6e0bm5vpYDhV3My6rMWTZZdE69DbPfmtbNEdTTvEbqMskkln*)
(*4wqzXuReWV3OXTpcu3Vj+erTv/s84tIPQ9zrGM3s2tpqgMlkQNkAvuqqagKz*)
(*EhHTaoBODpvs9ahTORQ8Bp1JnSxj8VqnZdaD17euHN+7Ab3dufeLO+uZjZWt*)
(*nNMb9fq8VqtRPr3o2c3lwiatMbyfz63t7EbdXofd7PGldpdXIlc23QpT1BbS*)
(*hZJejcmkiRVCFutaduvm6bXnzz/7NOd3qXoEDS1NHChrgMmqr0N4AJBWU1VV*)
(*XV2JHwBpC1glApOisP7sPAkVdiZb0CuaUV8+3j85ufTom9NCPPfik6sx6O9h*)
(*g9GfjHlMBr1CLDfEg3qJTK33hPMbl2/txkLpsD/kjbod8aQjux7UQ14nZRaj*)
(*RSfR6rxrfoczaY/u5k8//dWvPtmULJimu5u6u2HWBFln1tNphEuofERYRR01*)
(*FE7cmFCb0vp6Bv3tuA8csxsHZVLrxtraoyf7r58WC4exxKWsJbcRsFlU+pDf*)
(*7TFIdDad2ByNqfVWlxOmzVTI647noiGzwWPXxwJWq9drdCV8u06ZRGf2mrXW*)
(*YmT32DYnjuV2br735S93ZPPa8X4Bl1tLDZn02moKXSUcpXsAuIbMJwzyP8jM*)
(*XFdDI/sIakPBZDWMmCyxvY3Y3qc371yLxDeCenvaElpf8sWsOvPGh6cBrSsj*)
(*VWhtAbvfbve7PPGYN1BcKhYzNqvbXDi86pqZ01qMTlvaDcLq8UBiu4Lfv29U*)
(*KUKBSzcLD7/aT0U0I108eEqwc6DvSCcFsgrfCUy4U92IYScDPtnpMWpp+AXO*)
(*U4idyeIP61yh1ZOTxy+v5nPpSDESsrrVDr/RbNaY1e6jvaLbndbKdbp4IptI*)
(*rkDlp0K2YHYrZHe4fbHDwx2fckGrlYLWO6MBu0qoDzh9W19dSifTOWfi1sGP*)
(*Pz7aTimHWuqrGa31NFROqHWgj/CJKCm0cGvkkSoia4jSapcCSeIAutQj1nqW*)
(*7zz54t5BKndlaTdnM2hsIZtBKomuOU2xYMKlinqMNlMgsrudgsRMh3xRh9uj*)
(*tQQs7uWlvZDBKNVqJFKN1mI3R8wSrVm9un1pv1gIJ7220zs//OOb9eBCT2Nd*)
(*ZSWLUV1Xz6gGUgnOSnKU4l9RUQVNs560gNLukU5tJijjD8jrBYOztuP7J8/v*)
(*Xl7Z3Mjkc06ZyLIwp16UGJcigcjq9YgxkYo5HNbCe1mvx2V3ROPBWNBgsXo8*)
(*0ZV40qeXWtw6tVmtt6mknoRDbdAdbsSXk4VYMbTy5tqVX11J+hZ7G2sqWdOj*)
(*dbQ6UPdarHOCraKisnTAvQYUeXotaf1nyx0KJ5lRYYBuGbecPr59+2itmMnE*)
(*05lNl0a9uKhdGJfYHLHC2l7RD71HEUjaoKj0OoPWv53Jxj1elycWcPnUWp0s*)
(*njWaHT6jJeZNuS1Ot+f4SjoUW8lvrzx/sbn5YsliE/W1d3d0KifqqskYx6yt*)
(*qQKM5eWVBCiFuYqPIg+9v6q67i3IEpt4A6Xgd01nbz+/sxRxhAuXt4IJrxbz*)
(*0wSDhiqQNEiMYX/Qok94lAtyN3g5s3cnGc8kgxm30ev1GiwBezyVycaixsDu*)
(*6rpZ5stv7e8mrZGDvcOTB3eun746cCml4xMeTVdzJwuowjqBUqqtq6iso1dW*)
(*VFaUuK1EnAAP/qnEZu3ZQbx/HaOe19Knu/zF892gNXXzdjbqMpt1gbTbFnMo*)
(*JDrD4oQOSTIbVTqJ2W5Xyh3RlNPvT6bioXAcPUlxpZgrxP15VyScLSTSJsfW*)
(*9athd3Lp6NrV3Vt3n996lp+Zn+0bnW5hCfh0xMCA7g79p6qGXUUYrSLRr+BR*)
(*OOtKZ0jo1CKCTNLE+jFYnIaeqdDDT1/mzIWEM7uTT7tltlubRrx+XidZVNjN*)
(*oY24WabQO5d3cksR1/4lr9MXdrqyWZ/V6fIlV5IRo8qdB3ufyISTLpU5eCka*)
(*Wyku759s7dy+l7m6pZ0db0Ej2cCqZZBpkg7tvQp6UjlJ0VIhgffEsOM6rwZT*)
(*lIJJRn6Clw5zZ8uAavvk/ZsrKY8ulDq4lpLorux5jPpZkc4Qshui6ULAbNFq*)
(*ghsPd/KB4pUNvy3u8ThCSYcpYHM5XG6bwRBZjrqNjmDMHbDpLelAbC0Xyl+/*)
(*vnTn6dHJsWthqJELvYZJZ/JbuNAFiaGnUUlKcCJeLHcSa1p1RUUN/CcahRNG*)
(*KjKcgs2u53ZOZ44evfloKeVyOQ73cz61ObbiUE5KDBpH0O0PmTVuh1Gnj2VC*)
(*IVtmfzkQdssMBocvEE779FaP12mxJgJe06LamvA4LcFIwhV0a0L+zfvH97/5*)
(*xXtbkrFeAdYIOdlNrwEYNLIOgUmksqyCgARaeWwIO+5yaJUXymrJkqeOZCmt*)
(*NEaDF+W096h2nnz/68O9VHH30Aqzm1OhES9ogxalLl882Au7zRKZHX9r2+QI*)
(*L2/mN1JmhcoSzqVA7B3ZuM7i8OhVcrXOaLM4XMns6tKa1xDJXjp88PrOV48C*)
(*M4OtOFCwuA31DDCelRXllaCikIU0JLOidPAw7NT6iUavJ0searlXW0N9t47B*)
(*YjW1CIOH3/3q3nuP3nt94DCqbUmXSeNLeZVWb+h4bWV1za6SG21xr1lt3924*)
(*VPDn4g6zTOW3ir0udz4cWE/4PSp7LOpxGIw+z+5KIl1c275y5+jWzeMXb0KL*)
(*/Y08Hl683gCKVFNRzqFXVFTT8Ow3JmY5kajycuATg4zzEnR30rloF6txx0dD*)
(*0UV6GQxW04B+/c2vHz76/Ofvn+75VRKrJZFN5l0Kg8WxFEomAraA1RLfz9vM*)
(*sVRyy6Fz2ONOnVKv03tC4UQMJ/6Q1rG1m0+6LZ78ujd7+Tjn921cuXnj7vNP*)
(*YjNtDfyGpsYmHhMsSFXD/CiwVFFNZzHrgM3ycuq9nIo7WL4aapmLVJZX0DET*)
(*EDxJlbq6hu6Z5Cf/+PrZs48f7yytZ+M2RXAzFnSprOGQL5yMWMIr0fzy/kY6*)
(*H/SmbbNGrcLl8Lg0Vm903R8J6jypYCpSuH8jG/W60+s7u/v3b8Z84fzBB4+v*)
(*ff7YPNzM5wsaG5u5tdW1rOHMvVRLPQPUk81CnGXl1FEBwxHjbGqiehDJSvT6*)
(*ZI4iJVbDbB7U3vzzd6/uXz86LqxtnezFY+GYx2WyamwBp9+oi8X0Hlt4eTXt*)
(*D/v0yoDP7UtC1zfagvFMOOYPR83K5P7+UiaRTKxeOnly62TJ4dm6/vTF6o0v*)
(*d6a7GsmvMPDqq+i8Zlk0UHTyod3TWSx6JTJJIQX9rAdFwmGkuobSzdoasjfB*)
(*GaWGbCUgAWjcjsml3/7+7o3LhdOT9M6TZ9c3HC6/X6kVawN6hchsczjsi3O2*)
(*os/tcXn05mwqlFi22JI+TzQfWT6KRLxOTzhm9mwcPtxP5tZObxSd1uVbp1fX*)
(*P/jY0d+GSzgWl1VXXcNmj/ncUQufXlENUlpXCQDLCM6Ki3zESSMTUzUJNq00*)
(*PNNIMhDAgJPZMuj+6G9OLq8sn1xNFXfu34g43G6j0ubOLnvVVo9J49GMT/s3*)
(*TAqr1WNWuXRul1JuXS8sFXPFy7vFYiEG1tPiX9453HYZEyt7hyF/8SiTO/70*)
(*3mxfO5vDYdDZHGZNRTWnTWrRdzJrKmlMNrMWcJZdLCsnb+BD6NTchONS7dkK*)
(*CoZ8grKaij+N3tAlPf3+2aXM+tHpg3sry7eXvI6gTekOr57kwLrbtB63ybp7*)
(*LwiC73CajDK9fEZqSq+k/d7UaihUKK45vOlwJrJxdNWrVYY3s0s7hzevHNx+*)
(*mp4cbOVwWLW0ek5DfU1VLa6zGbTKKtDt+hpk8mIZOcrRL0F3J6NINa2UlITN*)
(*6tL0THDWsZuFmde/OTnevX7v2/vFpfWra7HC9saSz3FYsIrnlO6kPbWZ3k4F*)
(*DM5kLJW1+pw+qzcW8ftT2UTcGV5f88c8Kqc/v3M7ZVf6Nle37nzx4f3j26ua*)
(*ydFmfj0UOoPD5zAg1ZCyysoa6Nd0KKKysosXygjURi4L1RXnEDJ/0kqjPflE*)
(*ZlMqW8E2Kde/fn20euXjT7ddnuDm8XJ6PxO2ONc2LAsLMFoYLCkHJJc7WUhk*)
(*4/70RjFcCMM4mo+qVGa8PioS9VgjxbX9pD+5nU7vv/rd1/euHfsXxnt47Fqk*)
(*qJ4Lc28dNcTRoF0zq8spKi9eRKRNKKCIkwo87WwHUU2lQhWZ9+EHGZwmoWr5*)
(*l/cv371zHBVLfYWVVY9iQWoKxnbXQ7ZC1rMcigajcYd9KeV3W9z+TAFcqNvg*)
(*Ws+YxQu2sM2ZzESiqXhu/9rjO/vhYPzBL549eb6qnR3k1tWgb6+sxSsF8eow*)
(*Op4/rIdspVAiTjiaoZAw7oTQmrN4U1BJNpTCX1cvGJ4S3f7Ni89PN3PKCeel*)
(*nWubNtGsdT0TTUTWT/ORrUg0mt0qFGI+n92oDma20z6fL1HcOIoYjNFscXdz*)
(*a3tnxee++tmv7uZBn25+8OqbF+m5ic6akiOCqQMvC2fSwZGwWEwaSucZmXC0*)
(*CrCQkFB4USU+azAFqs+GZyoDauj1Lf3jmT98+ebu+o5HFb5/snOyshRK7aTV*)
(*1sjGdhp/QdsdiOT2vO6I32mIxQphnT4aShxfDiWjmc2bV5Op7d3dhHv/3slW*)
(*JL52+erNjz67rh0f5AM9ALK6orK6hsHhkl+zYMGshCDPGEW0HTDIMWh/kaA1*)
(*pWjjrF9ZGvXxq7o6Vtek6cG3nz1fPd4qrtz84HDryurq7kpAo/BmYyaFzpP1*)
(*ma0md8QdidqcFkk4b7LkL+8u+WOxQPbwcsoWuXx4vOLfebGzs7J9dOvu518+*)
(*zcwMddTT6eCLgBt6bUU5ox7oYEB7pJTzbXoC1K5mHodZKqSqUgFRixMKIcUp*)
(*+FYandknVWXfvP7uwbVr+zeu39uOZ/KrW0m/VWly6aVzU3MGp8Wst++srvoM*)
(*NqM2knNak0v5oM1s9wOdB0uFG+/dPrx2/dbtx/fee/Dm668+PvRNdvFqoUmW*)
(*w3xew6gmEa6ALKimxJ0kJ4C8iDh7IPAkQUuMluqn+izsZIzGdVQljdM9KXZ8*)
(*/ofPvrh5evzZo52lzeVoyBXYXg54AlmLQmKzZDbcxvDejUOT2R20OmR6u1uv*)
(*sMil/uzmYSS7W1i/ffPki2vbB0evXzz94MuPb8Q0A811oELl5dUMBgwZpR4J*)
(*WAmZF8+Osovny8r7Opp4LAatNNmfFXoNNeqX9ifV+M+VNazG1uGFzB9//OD3*)
(*b1786j5M4VsupdG+vbeRi6wnQvH4ytbSzvrq7lbAZTQFjEaT3+F06iwGVbwQ*)
(*9LmMFv/OzdtPbi9tHBw/v3/542/f24soOtlMRjXOFnU15Yjnwvmys1YJH8oI*)
(*kRegI10oKx/samngUMp0FvnqqtLGjBpKsb7wCxqd39HXL7r5d5/++MObb06y*)
(*K6mN9d2oOxEvHKbtjmAmvpaJX720v59zaBVSjSm6d2m/GPSFbK5w1u7LBWy+*)
(*0+ePD8LZna29g4cvf/fNnssobWPW8xlAAYK5eL7y/AX6mUHCDCgnFXThAumb*)
(*o73tSCjMzBRObAg1Z1GvJisTrK+aygpaXX1T84By47MfPn9v9+Z7G8nCjY9f*)
(*Xkp6PPbUJY8zvrq3e7y3ebCbj6f9Go1B7s+tb+YLqdjS/moslSluHV35+JNL*)
(*O7n140vbp5//7k1OOTI20ctjChrotIqLleUXL7zzs/KaJtpFqqW/LaELpcYp*)
(*HOhq4RNCSeekAk/VT4niyipUKsDJqqVz5mKJy49ef7C99fDNw1e/+eWjg6jZ*)
(*HSjcDcBEvn3t5XEilYmFNq57TUtZt8QSTa/t3nxwvJG5cnn79ge37j59/8rO*)
(*03tXH336j+8Fxwd7eodGBazmHi7M6fQKGHpo9OoLSCOlmD+lJ9GmqaHe9kYe*)
(*i2wdq3/CWUJYWpahQlVw2sB9za4nrYfvfXIvG73+7OVHH75/vB+2O/JHSffy*)
(*Xn7z0nbE5kmFVm/GY7mtuEQdD+dv3L9yeO3a1fW7721md0+uX3/67bNbT19/*)
(*Gehu7+nuG+jiCZr4jDp4krLzVX3tlQDxQnlJNeG4AEG/SAT03PmZ0f7OlgY2*)
(*9niyHS3txEsoqWVUNShcVZWgo4nL61Ar1Plrt3ej2xvr127DVPv8ZC21sVxY*)
(*X8pGcvvLuZxL7V1e8e4VouDdk8vJrd2daydH2yuXd/OrO9srl169Pn718c2c*)
(*V7840NUzPQjDBh2Es4xBv1DfUX2urOJi+cVyilGESVU7uS1MDGGGomeimnxN*)
(*zVl6VpZwVqKDqapsbGOwBTxet9RcuLeWPH745vX94yupp9+8vL68vH15bcUe*)
(*WEum1wKmUMrtSl2+vJ9b2juKx1Or23tb67uHmY2TK6cvXjx6cPjxveje08cJ*)
(*uXzWoOlg19ZxOZUXa2jlHZ1VwN+7DFblXzT2M6DlZdKZ0QEgtGSaqkt9veps*)
(*owuNt5J0tsoqGr2Owebz2sckqcf7oa0Hrz+8urea3rr27P17T18/ur1tt+fW*)
(*T3Zzvkg8vJTORHOXNnc2I6nCyu7q5s7hgdtz9OzBe1/99hcf3cwHNj9/fvPW*)
(*qj9i6mLU1HHYlWUXy8tpIPTnz79bw60sCdKZeJJiuqgghDai1pcUngJaWQp7*)
(*BVlCVuHqrKaOzmTzBN1Cd+FofevZvdPnR6vHNw+v3Pn4y68f3LqcX929+eTy*)
(*Vj4R8Szfve5y5FLZy4c7e3s7x7evFOLBwsmDk/tvfvzx5zmTQr26v31zYy06*)
(*28yEIZwGc1AVaE/FxfPnL6AmUbp5ASOP4SceVCPG61ha+Gw6ddLmp1ZU8jHl*)
(*uDtBzBVV1XWAky1oH1FET2+9ePr0m49e/vUf3r96/fT41kb+9sObV07unF5b*)
(*L0TXlo9PU8l8MrZ5fLyzvbu5vHFj/dKHh9e2Tj759vurMeWk3pNKhN2aCezZ*)
(*+AsJQAOKEUplZeVZpROcZ8p0USefGx/ugww9I7SK8vZUGVWQHU9FaU1ejb+G*)
(*y67ntQsd1z98eePlhw/e/+43nz68sn1wuJ7ZvXvtyt0Pn+4Vlq59eP32Db8+*)
(*vrWcLG7kd0+Wk5fuvvr0kxu3n371xXfPfSbZqH7pclg929PM5XDZnNZ2QV01*)
(*tCPSg+DpSJEToBcuUuWOim9UiafGBrtbGyjXVJJ3yizhWo+8V1BVX0PWKXQm*)
(*v0+68ezVy0t7B+vbVx4/uvveB0dLazdevXzx+Wcnu3vXnt1/8Or99fTq6kY8*)
(*UdzfvfXs1oPPv/zoxq1bP363lQ55tXihfWS+r7mBW08u7uYxGIwKVHcIXhlV*)
(*3uVnQMsoMb1QZtHK5iZGoOS5Z6afcnXVfyFM1IaH2D4Y8FlsXve0f3fz0YNr*)
(*J7evX1nbe/Td86OTe7ffv7bz/s9fv3zx7O6tg6394urlze1Lu0fXoJq27/zi*)
(*2cnr7797vhzJOB3GBaVicWJK1stiMCCPePTqWpiJMfCV1ZWURSrZpBKv5LAa*)
(*VKIZIUVoLVVCZxl6th2vqiQjNOEU7B2b19g2IlKEl44f3vvq4Y215at3r+4c*)
(*Xrp8+ujNZ2+++ObLz25fObp8ebu4tnnz+cuPT6/uZAqnL55//B8/zqoM1s2c*)
(*VDQtmu0bUtuH+DyBoKmzjVVTw6LTiW+qIIRSDuTC+ZImEV4v2s1a6dzEKNgm*)
(*itBSlycoq8haD/ksL73D92hMjqCxbXBMbFq+eQOI/Ozq8tq9Z/vLqUz+8MGX*)
(*33722cnmrcd3T/ZOT2+/fvXp18+fHW7eePTg/qs7Sza1xReJ6FRqYW933+JC*)
(*V3t7a+/U6EBTDVh5FgN6EtbL+Qs/0Xjh4llfunjRadUrkdCeNgFM9rS3vpgC*)
(*WlVB4SwtzSA0VTWMxiYuq2lkZCZ+vbB848bHH9x9/P23Nw5sxbWl3Sdf/emb*)
(*40vvvzg9Pbhy+uaT52++/PKzJy9eX92GfhWPLRXczkw+rB7pa2vs6Gjo7hjM*)
(*XVnsaKVDI6mrQ9NE3FHF+QtlVC8ilJbK3mU3aaR4ZWVnM4/a4Jx196pKApHS*)
(*pvKSL4SXwOC38Oo4A8PS2PqObtbgf/K7X3/30Y2D4MGzmzfe/+5//93n37z5*)
(*9Q/P33t07emrT37x118/unT10c2jnWQsHYq4vMePD+3j412Nbc3c9rEe84MT*)
(*Y083swqXmmCZzrx7Kdqk4C9QkMs9DotBIZoZH0JCGbgP+QlnqdIrwBRWkK6L*)
(*S/0qOkfAY7E7Bxd0dp1INqP0L2eW90Kx/Sdf/Orhx3/62z98/82nX/7ml7/4*)
(*5OuvP/7hhydPt/K55MP7a6v5QCgRLrw4NGpV0y1No6PNbUP96nRM29VaV4VL*)
(*xMpqsMNlFLwLF0pZSSjFz2V+F/6pq/nJ0X5i7ImIlpx8iVCyfsSLYcrLaPUA*)
(*tJbFgwG2pWdMbxQtaE2ZjM+mtNs0tqWte68/+eVvfv/+lYevvv3ld6+ePDt6*)
(*8jC/4dZpfFf2gr6w2RWzOdaj4aBprLl9uB9/V7prXNglYFdX0uGJq97W9gUK*)
(*4llmki/KIm6HVY+EDve2NeFuhHZ2GvSs3n+KelllDaCuYXLqGQx2U/fs2KJW*)
(*rIkt5wp+s25iRhtYOrjx+vPPXt6/ee/Ryd6KxxbPb/lkI0Zb1Ofyqq1qmU48*)
(*pba41OI+/L2daXULv7G3WwBTJI1ZzwTTRJV2CeOFvzwAZ8zntBlVkvmpsYGu*)
(*1gYOg/BJUFbgOreCwMRGQdIT3iuqcHSlM1j8lrbu3jGRLRo99hv8WoXZbpAs*)
(*iCRSqVJqL25cztsWA56l8NyYTC6cX3RZg965kUnh5PjIxFhbU1vjSGRZO9Iy*)
(*ohmrBTIZPB6tnErMC//jcR5xJgJuu1kjB0LBiII2YeSrSrL5ttBJQyNrMzgq*)
(*8RIO/FVGfmtnx5TWqFMklVaLWDo71i5o4Dc1NbT3tAuVWttcv9yTkyxKptuH*)
(*pfJozhOe5zYMCruam5uaBialvuBqYo7FG+uvZ9ZzWvmsqoslk/QTOopKiuAy*)
(*cDcOq0EpmZ8eH+rtaOGy8CKSqrenat/iLEefTR6qohpA0uvZjU3NXT2SaNE8*)
(*LRbOTU3NjXY0cJl0JofD6Rxoa+mbaOucczmnxAsLEy6fbanotA2zOXwY3Hjc*)
(*pjGZSTU7PQrjZkMDLmu4zJoyClkJJxgnuJ2n7pDdTTTqd4HWy0VzEPmODrxm*)
(*oJbgrHjbMqn0JJGnAFfT66HhdXXwW1q7JlWLwuHWxo6e7mYOT8Dhzc7zGQ19*)
(*o+Mzwu5uUSIWts0okjtxfz5mGODymIzuLl4jr6F7Yrh1sL+VzaQujWXhKIeQ*)
(*zqPKXzh3jiLzPB7vnqfEKhwNA6FGpWRhdmKku43PwnV95U8HwVlWQlhWmloB*)
(*KJvf1Ip/r2hwXDLbwW1qaRXUg7A2iw925nkN3MZe4UjnkEjj37qcil7a38xF*)
(*9aMwC4yJHPbOJgGXz+c3oaejk1/cY9dVVYDIV1UQ9gAnxSSF8zwV9vJIOOp3*)
(*2k1apQhLqZNscarPnDwxS+V/sd4jkAFoVS2zsaW5ua11ZEE1N9DaMdXZ1sTj*)
(*8NtbpUnvYkMLn9fQKRofGh0QO/ceFwJbx6m5Ng6L0124s58yd7Tye3u46CNL*)
(*J1Wh1MsulNNo6OcJvhLCs7hj4MtTwUgQCNXjb/FNDKOzhxmZaDwxHyTiZ9uo*)
(*i2c2qwwUivoTS43N7VxmvaC7Bbht4LW39YonGnmcWgancVo8yKezBUOaiV6T*)
(*f5zPpFXWdkeXIj5Dd4ego6WeSX6Jg47VAAbk4vny8nMY8RLAc+fPlYBSMMsq*)
(*CiF/EH/nHTIUCB0EZ49rRmzs5eWUxJeX/SXO0gH/TmPScY1fideW1nOg0Ln1*)
(*LBhz+XwuvZbBYncIB4d6uukXKgA0hwuCV17bIxQtmmY7Wnk8LhuviOVy65k4*)
(*dYCTR2zvnKNwIki89+7buIOvWI57A6SSgNAZ/D2PRg7Z12MBobSXCH3bJSjM*)
(*uFapJr4aR2kIYD2L38Bh02kAkI3zHquew65v6hxkXayoqquHaYVeXVnf2dM/*)
(*3CfgwjTY0NjUwOHywVHUVNNrITkR1Ll33z2HkT6HMM9RlJ4jcYcizuf83oDH*)
(*bjGooOQnsc0TI0rq56ddT9lZX7hYGlrgRjZ5JD0qqmpqmfgXNuorK6o5s1bX*)
(*NF5uXAcJCC6oqqa8sraezaiuYjS3dbSy6mjwYnhN0KQh9mCPL1ZWgpkDnITN*)
(*C4D23NuDij7CrEoVo24/9CSzTikRz44LB7uayXakshT0s+VzyR5QUIlJvFhe*)
(*0gKQfloVrZ4n4NGB2v7s0eGRTsCpqcYrDarKq2ouXKyoY9bX1dSx2OSitFqA*)
(*zWLQKsEhIbh336XCWwo6kErdzpXS4AJx+ol8xuPyu20Wo1oOVnsCZrpGzttL*)
(*SUrL0jMXc9YgECe4RDTgFTg4VdVUV9TyBfx6Wh1LdDNtiqV7GeSsBb0GL+e9*)
(*WE7WxHRyQQWe4WOzaOWkrAkaEmmqfM6dsfkugU/ylOCsSacLYYfXg3+KQymV*)
(*LEyNDfWQma668i9xUk4QwZ0BPk/JGkSEMoBlVUwOl8tn8qYyKU9M0VJbUY3X*)
(*bleVru+pqSPXcJFT5XV0Oq0coRE6z7CVQL5L7r37Fm4JJy0LhLqdXpfNpMe/*)
(*oDw7iesRELeaqpID+XfupdTPSupG1SLpAfBqamASZzNYXSKdVdpSX4tDH72K*)
(*TLr4QLilINfw4NUytIoLgKQU5nfeIajeRQrxOEc+nztPfYLmBINxVW0qlSqG*)
(*7C6oJDCwcsnizMQI1DyvHpsnlX4EJtUjfsL4U6Dg+1hm58rYDHpdJZRMY2db*)
(*fW1VFY7QteWYxrjmKKvBSZCc2auFJvkXjP0Pxzv4fq6EHGDi8oFGD2eSuYzL*)
(*5nFaTAb8Y4bgR0DtBRw6sU2lgfpCiT+SUufeZlMprwAnfO8ijYaXIFTh+eWa*)
(*CjQr9UwaZgopjfNlZBgnI2U5xdS7P6NQka8IqRRMPKhCIrTCj1VW19Z7E8lU*)
(*MWxxuq1m/OsMEtHM1ARMyXyq5imcZzxeOMNZUjjqM45d+LIroFUzofBraRBz*)
(*vESfSSsjgaWe8Nz5i1RHPFcC9c7PCKh3yfs7Z1RS33ubBxh2kAw6yxlMxHJZ*)
(*u8WNf3hfo5DJFyanRvvfihNWK0nMtx2NihWV89Rn4AroLB+Y57NYeIkR9cv3*)
(*TGZt2VnGvfsOFcNz5N67594p0XZ2vPvv775NVfLqLkJHoXMs7nA0UYiYHC6L*)
(*0ahXK+TyeUhRMizRycUvVNz/IjN/yiQK6bvnyqAqLpS3dkHkydW49RxySo3A*)
(*fIdgOn8env5nP3vn3Ds/QzA/o776GblRX/472O9iTryDOQGigCXI5OlsvlAo*)
(*k7UbXTYjyVBMUeFwaZFTRWUoCTxpD+fO//8yH3Xu4kX4gP/nYmUt8dDYasov*)
(*nOVbCWsJHMQbAVJ4f3Z2r8Tp2/Qs/SQmVXkVjc5uUOntPn84FzFYnUajESOP*)
(*f1pNCCrayK0nlxORDH3bdc+9WyrSd37CegEIfeccUe2LFeTkTmX5BfJs56jn*)
(*PYNFAfuf36Ir3f3ZO/+O0794edg0wegweU0ytdHu8UbTToPdqgdG1fjnZucm*)
(*cYXXyAEZRaAXS0DPlJhw+s5Pt3PQSc/hAxNaz5Ea+dkZOaXwvmWvhOz/K+tM*)
(*n9IGogA+YzYb7Hj0QEurFgHFoQySCko8GETCKQkhgGC1Q9uZ9ov///e+tzcW*)
(*Z4CYDPnl3ZvjLSASSQnoVBsENZwexLmF4szk/X4wfXxavvydThaTeDbFNlZt*)
(*jKJuMZ/B6zVvuSsJD0pIZUvL4+rBPJpI8NGCI3dHDRkKHpvBMUB4I/bKOm24*)
(*Uq4QlMA6d6FsKdz6vSBeLJYvy3g2G8fY+m/Qbd9BFHWLx6J0wjO9PBk70jXQ*)
(*cQ1zSohhF26ljFEZogQiApQQg1AfCDXEb1N++DAYg1Isky/WATScLB5+/5lH*)
(*YJ+TGLtndvzb+iWeckrj9YVt4ESJJlQkFnZuU60mh9UTjjgQjkdXQADOQhny*)
(*P6F1wmzCVobKJM2WUOuQMbehtEnnCqfYhRFUP5n9Wk7jGDjjUYDP52FeKhc0*)
(*KIrKEXYpHdShhlk5ymcpNaTE9Iwf+qU52ZKGtsV2bFFgvttJHWTzpW/e1c2t*)
(*3x2Oo/nP50kYjXHKnWEfnR6jE4By1XOfdxJc3+L1Ku4RIpybSicnlkITJJam*)
(*tQURIaugFn5lSueY+4f5YvnsvFa7abQ6QRjMnuZhMB5HUYjztmAPWq/CQXdg*)
(*qIVRlFe1jsEo4vRqPFQeQ8R+pRDxZeGiJdmJsFolXwGMmG8QM/lx7/CoUHIr*)
(*leqFd9Vo+YP+/RRAwziOUKCszfQ1Pr5/hJe9Pwivx6CzkuaoGQZtJRMRd4iW*)
(*qIK0pK5tW0nV1lInLKKxam6T3cb0JXeCbQ2xifv5Zb3h93rD2Y+HYBSPR6xf*)
(*YauJ07/guZwMVGyQmTaZ7lGiIgkr7SvTss1vHFJxWsY734DahoiNGMCi8AYO*)
(*NkCa6dwJNrbz3LLrulWv3mh1e4PZ82QYRNjm/r7fYX27a2enXyGO4plmZaSO*)
(*9iTKIroilUokhp9oDku+Ka8SJrq2ptDxV9dxoLCFN9Wm9ljHMLfiXZfLpdKp*)
(*W70Ev293B/On8SBg80EB6B0DrZSLeAsJ3kmwtSkTkwpKRpbhpYVyWO0sptbZ*)
(*p/qvsZb/BOYQHCNC9n2f3P20n87mCyVsEdnAGb2w22/Nu252OsPH71EfQUcw*)
(*qmv7DLQKoNkD8CZePglQSmWIJKs+ZOyXy+9VTPrPDji+wFxPgMbXN3DQAmUX*)
(*tg3ifT+bfPYBnGro4qrZbg/ni7CHqg+H9wKUdUDJpdmD9EAqcqiOTdz0zexN*)
(*TBjL9KSVlWy9RXT+wXwOXg6joWQylfp8kDlmLTm8m2bL/wdOBp4G*)
(*"], "Byte", ColorSpace -> "Grayscale", Interleaving -> None, MetaInformation -> Association["Exif" -> Association["ImageWidth" -> 438, "ImageLength" -> 470, "BitsPerSample" -> 8, "Compression" -> "Uncompressed", "PhotometricInterpretation" -> "Black Is Zero", "FillOrder" -> 1, "ImageDescription" -> "ImageJ=1.51r\nimages=120\nslices=120\nunit=\\u00B5m\nloop=false\nmin=1258.0\nmax=13053.0", "StripOffsets" -> {770, 7778, 14786, 21794, 28802, 35810, 42818, 49826, 56834, 63842, 70850, 77858, 84866, 91874, 98882, 105890, 112898, 119906, 126914, 133922, 140930, 147938, 154946, 161954, 168962, 175970, 182978, 189986, 196994, 204002}, "SamplesPerPixel" -> 1, "RowsPerStrip" -> 16, "StripByteCounts" -> {7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 7008, 2628}, "XResolution" -> 72, "YResolution" -> 72, "PlanarConfiguration" -> 2, "ResolutionUnit" -> "inch", "Software" -> "Created with the Wolfram Language for Students - Personal Use Only : www.wolfram.com", "DateTime" -> DateObject[{2018, 3, 10, 1, 58, 19.}, "Instant", "Gregorian", 2.], "Artist" -> "Created with the Wolfram Language for Students - Personal Use Only : www.wolfram.com", "SampleFormat" -> "Unsigned integer data"]]]]//Binarize*)


(* ::Section:: *)
(*Training UNet*)


(* ::Input:: *)
(*(* images/masks need to be resized and shuffled *)*)


(* ::Input:: *)
(*dir="C:\\Users\\aliha\\Downloads\\fabrice-ali\\deeplearning\\data\\train\\train_images_8bit";*)


(* ::Input:: *)
(*SetDirectory[dir];*)


(* ::Input:: *)
(*images=ImageResize[Import[dir<>"\\"<>#],{168,168}]&/@FileNames[];*)


(* ::Input:: *)
(*shuffledimages=RandomSample@Thread[Range@Length@images ->images];*)


(* ::Input:: *)
(*keysshuffle=Keys@shuffledimages;*)


(* ::Input:: *)
(*dir="C:\\Users\\aliha\\Downloads\\fabrice-ali\\deeplearning\\data\\train\\train_masks";*)


(* ::Input:: *)
(*SetDirectory[dir];*)


(* ::Input:: *)
(*masks=Binarize[ImageResize[Import[dir<>"\\"<>#],{160,160}]]&/@FileNames[];*)


(* ::Input:: *)
(*shuffledmasks=Lookup[<|Thread[Range@Length@masks -> masks]|>,keysshuffle];*)


(* ::Input:: *)
(*(* split datasets into training and validation sets after shuffling *)*)


(* ::Input:: *)
(*{dataset,validationset,unseen}=TakeList[Values@shuffledimages,{290,80,20}];*)


(* ::Input:: *)
(*{labeldataset,labelvalidationset,groundTruth}=TakeList[shuffledmasks,{290,80,20}];*)


(* ::Input:: *)
(*(* train Net over Nvidia GPU *)*)


(* ::Input:: *)
(*trainedNN=NetTrain[net,Thread[dataset->labeldataset],*)
(*ValidationSet->Thread[validationset-> labelvalidationset],*)
(*BatchSize->8,MaxTrainingRounds->100, TargetDevice->"GPU" ]*)


(* ::Input:: *)
(*img=RandomChoice@unseen*)


(* ::Input:: *)
(*unseen//Length*)


(* ::Input:: *)
(*res=ImageResize[trainedNN[img],{168,168}]*)


(* ::Input:: *)
(*HighlightImage[ img,MorphologicalPerimeter@Binarize@res ]*)
